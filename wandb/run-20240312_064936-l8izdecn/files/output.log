
  0%|                                                                                                                    | 0/189 [00:00<?, ?it/s]/opt/conda/envs/cs224n-project-env/lib/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/opt/conda/envs/cs224n-project-env/lib/python3.9/site-packages/bitsandbytes/autograd/_functions.py:298: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
`use_cache = True` is incompatible with gradient checkpointing. Setting `use_cache = False`...



















 11%|███████████                                                                                              | 20/189 [08:35<1:09:40, 24.74s/it]




















 21%|██████████████████████▏                                                                                  | 40/189 [16:50<1:01:19, 24.70s/it]




















 32%|█████████████████████████████████▉                                                                         | 60/189 [25:02<52:51, 24.59s/it]




















 42%|█████████████████████████████████████████████▎                                                             | 80/189 [33:05<44:51, 24.69s/it]




















 53%|████████████████████████████████████████████████████████                                                  | 100/189 [41:19<36:41, 24.74s/it]



















 63%|██████████████████████████████████████████████████████████████████▋                                       | 119/189 [49:09<28:52, 24.75s/it]




















 74%|█████████████████████████████████████████████████████████████████████████████▉                            | 139/189 [57:11<20:41, 24.83s/it]





















 85%|████████████████████████████████████████████████████████████████████████████████████████                | 160/189 [1:05:51<11:55, 24.69s/it]



















 95%|██████████████████████████████████████████████████████████████████████████████████████████████████▍     | 179/189 [1:13:46<04:09, 24.98s/it]










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:23<00:00, 24.57s/it]
{'train_runtime': 4649.1705, 'train_samples_per_second': 0.645, 'train_steps_per_second': 0.041, 'train_loss': 45.11567502299314, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-zaf




adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 231M/231M [00:06<00:00, 35.2MB/s]
Running training process 1 ...
Hyperparameters are (0.001, 16, 64)
Load 8bit model...
Start training...
/opt/conda/envs/cs224n-project-env/lib/python3.9/site-packages/peft/utils/other.py:145: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
  0%|                                                                                                                    | 0/189 [00:00<?, ?it/s]



















 10%|██████████▌                                                                                              | 19/189 [08:12<1:10:39, 24.94s/it]





















 21%|██████████████████████▏                                                                                  | 40/189 [16:52<1:01:45, 24.87s/it]



















 31%|█████████████████████████████████▍                                                                         | 59/189 [24:45<53:46, 24.82s/it]





















 42%|█████████████████████████████████████████████▎                                                             | 80/189 [33:14<44:51, 24.69s/it]




















 53%|████████████████████████████████████████████████████████                                                  | 100/189 [41:30<36:43, 24.76s/it]




















 63%|███████████████████████████████████████████████████████████████████▎                                      | 120/189 [49:47<28:41, 24.95s/it]




















 74%|██████████████████████████████████████████████████████████████████████████████▌                           | 140/189 [57:51<20:18, 24.87s/it]




















 85%|████████████████████████████████████████████████████████████████████████████████████████                | 160/189 [1:06:09<11:59, 24.82s/it]




















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████     | 180/189 [1:14:25<03:43, 24.81s/it]








100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:36<00:00, 24.64s/it]
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.24MB/s]
{'train_runtime': 4656.8716, 'train_samples_per_second': 0.644, 'train_steps_per_second': 0.041, 'train_loss': 43.53295559353299, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-zaf




adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 462M/462M [00:09<00:00, 47.7MB/s]
Running training process 2 ...
Hyperparameters are (0.001, 16, 128)
Load 8bit model...
Start training...
trainable params: 230,686,720 || all params: 1,773,991,680 || trainable%: 13.0038219795935




















 11%|███████████                                                                                              | 20/189 [08:37<1:10:01, 24.86s/it]




















 21%|██████████████████████▏                                                                                  | 40/189 [16:54<1:01:53, 24.92s/it]




















 32%|█████████████████████████████████▉                                                                         | 60/189 [25:10<53:11, 24.74s/it]




















 42%|█████████████████████████████████████████████▎                                                             | 80/189 [33:14<45:02, 24.79s/it]




















 53%|████████████████████████████████████████████████████████                                                  | 100/189 [41:29<36:46, 24.79s/it]




















 63%|███████████████████████████████████████████████████████████████████▎                                      | 120/189 [49:48<28:42, 24.97s/it]




















 74%|██████████████████████████████████████████████████████████████████████████████▌                           | 140/189 [57:54<20:27, 25.05s/it]



















 84%|███████████████████████████████████████████████████████████████████████████████████████▍                | 159/189 [1:05:50<12:33, 25.13s/it]




















 95%|██████████████████████████████████████████████████████████████████████████████████████████████████▍     | 179/189 [1:14:10<04:09, 24.95s/it]









 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍| 188/189 [1:17:46<00:22, 22.06s/it]
{'train_runtime': 4669.2654, 'train_samples_per_second': 0.642, 'train_steps_per_second': 0.04, 'train_loss': 45.45941937158978, 'epoch': 3.0}
Done with training! Pushing to hub...

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:49<00:00, 24.71s/it]








adapter_model.safetensors:  92%|███████████████████████████████████████████████████████████████████████▋      | 848M/923M [00:16<00:01, 60.9MB/s]
Running training process 3 ...
Hyperparameters are (0.001, 32, 32)
Load 8bit model...

adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 923M/923M [00:17<00:00, 51.8MB/s]
trainable params: 57,671,680 || all params: 1,600,976,640 || trainable%: 3.602281167575312



















 20%|████████████████████▉                                                                                     | 19/96 [16:12<1:02:55, 49.03s/it]




















 41%|███████████████████████████████████████████▉                                                                | 39/96 [31:58<46:47, 49.25s/it]




















 61%|██████████████████████████████████████████████████████████████████▍                                         | 59/96 [48:21<30:14, 49.04s/it]




















 82%|███████████████████████████████████████████████████████████████████████████████████████▏                  | 79/96 [1:04:02<13:53, 49.03s/it]
















 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 95/96 [1:16:35<00:39, 39.89s/it]
{'train_runtime': 4598.0678, 'train_samples_per_second': 0.652, 'train_steps_per_second': 0.021, 'train_loss': 49.2755184173584, 'epoch': 3.0}
Done with training! Pushing to hub...

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:38<00:00, 47.90s/it]


adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 231M/231M [00:05<00:00, 44.9MB/s]
Running training process 4 ...
Hyperparameters are (0.001, 32, 64)
Load 8bit model...
Start training...
trainable params: 115,343,360 || all params: 1,658,648,320 || trainable%: 6.9540576268753584



















 20%|████████████████████▉                                                                                     | 19/96 [16:13<1:03:20, 49.35s/it]




















 41%|███████████████████████████████████████████▉                                                                | 39/96 [32:00<46:40, 49.13s/it]




















 61%|██████████████████████████████████████████████████████████████████▍                                         | 59/96 [48:22<30:20, 49.19s/it]




















 82%|███████████████████████████████████████████████████████████████████████████████████████▏                  | 79/96 [1:04:08<13:54, 49.10s/it]

















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:48<00:00, 48.00s/it]
{'train_runtime': 4608.27, 'train_samples_per_second': 0.651, 'train_steps_per_second': 0.021, 'train_loss': 47.7098503112793, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-zaf






adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 462M/462M [00:12<00:00, 37.5MB/s]
Running training process 5 ...
Hyperparameters are (0.001, 32, 128)
Load 8bit model...
Start training...
trainable params: 230,686,720 || all params: 1,773,991,680 || trainable%: 13.0038219795935




















 21%|██████████████████████                                                                                    | 20/96 [17:00<1:02:11, 49.10s/it]



















 41%|███████████████████████████████████████████▉                                                                | 39/96 [31:56<46:33, 49.00s/it]




















 61%|██████████████████████████████████████████████████████████████████▍                                         | 59/96 [48:17<30:16, 49.10s/it]





















 83%|████████████████████████████████████████████████████████████████████████████████████████▎                 | 80/96 [1:04:52<13:04, 49.03s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:41<00:00, 47.93s/it]
{'train_runtime': 4601.2326, 'train_samples_per_second': 0.652, 'train_steps_per_second': 0.021, 'train_loss': 47.45609919230143, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-zaf










adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 923M/923M [00:20<00:00, 45.4MB/s]
Running training process 6 ...
Hyperparameters are (0.001, 64, 32)
Load 8bit model...
Start training...
trainable params: 57,671,680 || all params: 1,600,976,640 || trainable%: 3.602281167575312



















 40%|██████████████████████████████████████████▊                                                                 | 19/48 [31:32<47:21, 97.97s/it]





















 83%|████████████████████████████████████████████████████████████████████████████████████████▎                 | 40/48 [1:04:53<12:55, 96.96s/it]







 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 47/48 [1:15:45<01:28, 88.54s/it]
{'train_runtime': 4556.3504, 'train_samples_per_second': 0.658, 'train_steps_per_second': 0.011, 'train_loss': 50.15656280517578, 'epoch': 3.0}
Done with training! Pushing to hub...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [1:15:56<00:00, 94.92s/it]



adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 231M/231M [00:06<00:00, 38.5MB/s]
Running training process 7 ...
Hyperparameters are (0.001, 64, 64)
Load 8bit model...
Start training...
  0%|                                                                                                                     | 0/48 [00:00<?, ?it/s]




















 42%|█████████████████████████████████████████████                                                               | 20/48 [33:15<45:43, 97.97s/it]




















 83%|████████████████████████████████████████████████████████████████████████████████████████▎                 | 40/48 [1:04:59<12:55, 96.99s/it]








100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [1:16:02<00:00, 95.06s/it]
{'train_runtime': 4562.8524, 'train_samples_per_second': 0.657, 'train_steps_per_second': 0.011, 'train_loss': 49.3702392578125, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-zaf





adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 462M/462M [00:10<00:00, 42.1MB/s]
Running training process 8 ...
Hyperparameters are (0.001, 64, 128)
Load 8bit model...
Start training...
  0%|                                                                                                                     | 0/48 [00:00<?, ?it/s]




















 42%|█████████████████████████████████████████████                                                               | 20/48 [33:08<45:36, 97.72s/it]



















 81%|██████████████████████████████████████████████████████████████████████████████████████▏                   | 39/48 [1:03:26<14:38, 97.63s/it]








 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 47/48 [1:15:58<01:28, 88.67s/it]
{'train_runtime': 4569.6157, 'train_samples_per_second': 0.657, 'train_steps_per_second': 0.011, 'train_loss': 50.13061205546061, 'epoch': 3.0}
Done with training! Pushing to hub...

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [1:16:09<00:00, 95.20s/it]











adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 923M/923M [00:22<00:00, 41.4MB/s]