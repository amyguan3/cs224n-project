
  0%|                                                                                                                    | 0/189 [00:00<?, ?it/s]/opt/conda/envs/cs224n-project-env/lib/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/opt/conda/envs/cs224n-project-env/lib/python3.9/site-packages/bitsandbytes/autograd/_functions.py:298: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
`use_cache = True` is incompatible with gradient checkpointing. Setting `use_cache = False`...



















 11%|███████████                                                                                              | 20/189 [08:33<1:09:30, 24.68s/it]



















 21%|█████████████████████▋                                                                                   | 39/189 [16:20<1:01:25, 24.57s/it]




















 31%|█████████████████████████████████▍                                                                         | 59/189 [24:31<53:04, 24.50s/it]





















 42%|█████████████████████████████████████████████▎                                                             | 80/189 [32:55<44:32, 24.52s/it]




















 53%|████████████████████████████████████████████████████████                                                  | 100/189 [41:06<36:20, 24.50s/it]




















 63%|███████████████████████████████████████████████████████████████████▎                                      | 120/189 [49:17<28:11, 24.52s/it]




















 74%|██████████████████████████████████████████████████████████████████████████████▌                           | 140/189 [57:15<20:01, 24.52s/it]



















 84%|███████████████████████████████████████████████████████████████████████████████████████▍                | 159/189 [1:05:02<12:14, 24.49s/it]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████     | 180/189 [1:13:40<03:42, 24.67s/it]








100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:16:50<00:00, 24.39s/it]
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.09MB/s]
{'train_runtime': 4615.9204, 'train_samples_per_second': 0.65, 'train_steps_per_second': 0.041, 'train_loss': 47.494573522497106, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-0



adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 231M/231M [00:06<00:00, 35.3MB/s]
Running training process 1 ...
Hyperparameters are (0.001, 16, 64)
Load 8bit model...
Start training...
/opt/conda/envs/cs224n-project-env/lib/python3.9/site-packages/peft/utils/other.py:145: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
trainable params: 115,343,360 || all params: 1,658,648,320 || trainable%: 6.9540576268753584




















 11%|███████████                                                                                              | 20/189 [08:35<1:09:41, 24.74s/it]




















 21%|██████████████████████▏                                                                                  | 40/189 [16:48<1:01:16, 24.67s/it]




















 32%|█████████████████████████████████▉                                                                         | 60/189 [25:00<52:50, 24.58s/it]



















 42%|████████████████████████████████████████████▋                                                              | 79/189 [32:35<45:09, 24.63s/it]





















 53%|████████████████████████████████████████████████████████                                                  | 100/189 [41:13<36:31, 24.62s/it]



















 63%|██████████████████████████████████████████████████████████████████▋                                       | 119/189 [49:01<28:48, 24.69s/it]




















 74%|█████████████████████████████████████████████████████████████████████████████▉                            | 139/189 [57:02<20:30, 24.61s/it]





















 85%|████████████████████████████████████████████████████████████████████████████████████████                | 160/189 [1:05:43<11:57, 24.73s/it]




















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████     | 180/189 [1:14:00<03:44, 24.91s/it]








 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍| 188/189 [1:17:08<00:21, 21.72s/it]
{'train_runtime': 4630.9999, 'train_samples_per_second': 0.648, 'train_steps_per_second': 0.041, 'train_loss': 48.04181311874793, 'epoch': 3.0}
Done with training! Pushing to hub...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:10<00:00, 24.50s/it]
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.07MB/s]





adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 462M/462M [00:09<00:00, 50.5MB/s]
Running training process 2 ...
Hyperparameters are (0.001, 16, 128)
Load 8bit model...
Start training...
trainable params: 230,686,720 || all params: 1,773,991,680 || trainable%: 13.0038219795935




















 11%|███████████                                                                                              | 20/189 [08:35<1:10:01, 24.86s/it]




















 21%|██████████████████████▏                                                                                  | 40/189 [16:52<1:01:58, 24.96s/it]




















 32%|█████████████████████████████████▉                                                                         | 60/189 [25:07<53:02, 24.67s/it]




















 42%|█████████████████████████████████████████████▎                                                             | 80/189 [33:10<44:50, 24.69s/it]




















 53%|████████████████████████████████████████████████████████                                                  | 100/189 [41:25<36:38, 24.70s/it]




















 63%|███████████████████████████████████████████████████████████████████▎                                      | 120/189 [49:41<28:36, 24.87s/it]




















 74%|██████████████████████████████████████████████████████████████████████████████▌                           | 140/189 [57:45<20:22, 24.95s/it]




















 85%|████████████████████████████████████████████████████████████████████████████████████████                | 160/189 [1:06:01<11:58, 24.79s/it]




















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████     | 180/189 [1:14:15<03:42, 24.74s/it]








100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:25<00:00, 24.58s/it]
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.10MB/s]
{'train_runtime': 4645.8817, 'train_samples_per_second': 0.646, 'train_steps_per_second': 0.041, 'train_loss': 49.894155673879794, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-2









adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 923M/923M [00:17<00:00, 51.3MB/s]
Running training process 3 ...
Hyperparameters are (0.005, 16, 32)
Load 8bit model...
Start training...
trainable params: 57,671,680 || all params: 1,600,976,640 || trainable%: 3.602281167575312




















 11%|███████████                                                                                              | 20/189 [08:36<1:10:08, 24.90s/it]



















 21%|█████████████████████▋                                                                                   | 39/189 [16:28<1:02:08, 24.85s/it]




















 31%|█████████████████████████████████▍                                                                         | 59/189 [24:41<53:18, 24.61s/it]




















 42%|████████████████████████████████████████████▋                                                              | 79/189 [32:42<45:12, 24.66s/it]




















 52%|████████████████████████████████████████████████████████                                                   | 99/189 [40:56<37:09, 24.77s/it]




















 63%|██████████████████████████████████████████████████████████████████▋                                       | 119/189 [49:10<29:00, 24.86s/it]




















 74%|█████████████████████████████████████████████████████████████████████████████▉                            | 139/189 [57:13<20:31, 24.62s/it]





















 85%|████████████████████████████████████████████████████████████████████████████████████████                | 160/189 [1:05:54<12:00, 24.86s/it]



















 95%|██████████████████████████████████████████████████████████████████████████████████████████████████▍     | 179/189 [1:13:44<04:08, 24.83s/it]









 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍| 188/189 [1:17:17<00:21, 21.76s/it]
{'train_runtime': 4640.4376, 'train_samples_per_second': 0.646, 'train_steps_per_second': 0.041, 'train_loss': 203.12254438450728, 'epoch': 3.0}
Done with training! Pushing to hub...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:20<00:00, 24.55s/it]
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.10MB/s]


adapter_model.safetensors:  90%|█████████████████████████████████████████████████████████████████████▉        | 207M/231M [00:05<00:00, 50.9MB/s]
Running training process 4 ...
Hyperparameters are (0.005, 16, 64)
Load 8bit model...

adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 231M/231M [00:05<00:00, 38.7MB/s]
trainable params: 115,343,360 || all params: 1,658,648,320 || trainable%: 6.9540576268753584



















 10%|██████████▌                                                                                              | 19/189 [08:11<1:10:41, 24.95s/it]




















 21%|█████████████████████▋                                                                                   | 39/189 [16:27<1:01:45, 24.70s/it]




















 31%|█████████████████████████████████▍                                                                         | 59/189 [24:42<53:23, 24.64s/it]




















 42%|████████████████████████████████████████████▋                                                              | 79/189 [32:45<45:16, 24.69s/it]




















 52%|████████████████████████████████████████████████████████                                                   | 99/189 [41:00<37:16, 24.85s/it]




















 63%|██████████████████████████████████████████████████████████████████▋                                       | 119/189 [49:15<28:58, 24.83s/it]




















 74%|█████████████████████████████████████████████████████████████████████████████▉                            | 139/189 [57:19<20:38, 24.77s/it]




















 84%|███████████████████████████████████████████████████████████████████████████████████████▍                | 159/189 [1:05:36<12:22, 24.76s/it]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████     | 180/189 [1:14:17<03:43, 24.87s/it]









100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:29<00:00, 24.60s/it]
{'train_runtime': 4649.764, 'train_samples_per_second': 0.645, 'train_steps_per_second': 0.041, 'train_loss': 190.08075500165344, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-4
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.08MB/s]





adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 462M/462M [00:10<00:00, 43.7MB/s]
Running training process 5 ...
Hyperparameters are (0.005, 16, 128)
Load 8bit model...
Start training...
trainable params: 230,686,720 || all params: 1,773,991,680 || trainable%: 13.0038219795935



















 10%|██████████▌                                                                                              | 19/189 [08:10<1:10:12, 24.78s/it]




















 21%|█████████████████████▋                                                                                   | 39/189 [16:25<1:01:51, 24.75s/it]





















 32%|█████████████████████████████████▉                                                                         | 60/189 [25:01<52:45, 24.54s/it]




















 42%|█████████████████████████████████████████████▎                                                             | 80/189 [33:02<44:44, 24.63s/it]



















 52%|████████████████████████████████████████████████████████                                                   | 99/189 [40:53<37:16, 24.85s/it]




















 63%|██████████████████████████████████████████████████████████████████▋                                       | 119/189 [49:09<29:04, 24.92s/it]





















 74%|██████████████████████████████████████████████████████████████████████████████▌                           | 140/189 [57:37<20:16, 24.82s/it]




















 85%|████████████████████████████████████████████████████████████████████████████████████████                | 160/189 [1:05:52<11:57, 24.75s/it]




















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████     | 180/189 [1:14:08<03:43, 24.82s/it]








 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍| 188/189 [1:17:16<00:21, 21.83s/it]
{'train_runtime': 4639.8093, 'train_samples_per_second': 0.647, 'train_steps_per_second': 0.041, 'train_loss': 182.7788550967262, 'epoch': 3.0}
Done with training! Pushing to hub...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 189/189 [1:17:19<00:00, 24.55s/it]
README.md: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 5.18k/5.18k [00:00<00:00, 1.08MB/s]










adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 923M/923M [00:20<00:00, 46.1MB/s]
Running training process 6 ...
Hyperparameters are (0.001, 32, 32)
Load 8bit model...
Start training...
trainable params: 57,671,680 || all params: 1,600,976,640 || trainable%: 3.602281167575312



















 20%|████████████████████▉                                                                                     | 19/96 [16:06<1:02:49, 48.95s/it]




















 41%|███████████████████████████████████████████▉                                                                | 39/96 [31:47<46:29, 48.95s/it]




















 61%|██████████████████████████████████████████████████████████████████▍                                         | 59/96 [48:03<30:08, 48.88s/it]





















 83%|████████████████████████████████████████████████████████████████████████████████████████▎                 | 80/96 [1:04:31<13:00, 48.79s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:15<00:00, 28.69s/it]
{'train_runtime': 4575.0873, 'train_samples_per_second': 0.656, 'train_steps_per_second': 0.021, 'train_loss': 52.06996218363444, 'epoch': 3.0}
Done with training! Pushing to hub...

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:15<00:00, 47.66s/it]



adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 231M/231M [00:06<00:00, 37.2MB/s]
Running training process 7 ...
Hyperparameters are (0.001, 32, 64)
Load 8bit model...
Start training...
  0%|                                                                                                                     | 0/96 [00:00<?, ?it/s]




















 21%|██████████████████████                                                                                    | 20/96 [16:57<1:01:56, 48.90s/it]




















 42%|█████████████████████████████████████████████                                                               | 40/96 [32:40<45:27, 48.71s/it]




















 62%|███████████████████████████████████████████████████████████████████▌                                        | 60/96 [48:55<29:16, 48.79s/it]




















 83%|████████████████████████████████████████████████████████████████████████████████████████▎                 | 80/96 [1:04:39<13:05, 49.07s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:24<00:00, 47.76s/it]
{'train_runtime': 4584.9156, 'train_samples_per_second': 0.654, 'train_steps_per_second': 0.021, 'train_loss': 54.07288932800293, 'epoch': 3.0}
Done with training! Pushing to hub...
asyzhou/224n-whisper-large-overnight-7






adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 462M/462M [00:11<00:00, 40.1MB/s]
Running training process 8 ...
Hyperparameters are (0.001, 32, 128)
Load 8bit model...
Start training...
  0%|                                                                                                                     | 0/96 [00:00<?, ?it/s]




















 21%|██████████████████████                                                                                    | 20/96 [16:56<1:01:58, 48.92s/it]




















 42%|█████████████████████████████████████████████                                                               | 40/96 [32:36<45:17, 48.53s/it]



















 61%|██████████████████████████████████████████████████████████████████▍                                         | 59/96 [48:03<30:11, 48.96s/it]




















 82%|███████████████████████████████████████████████████████████████████████████████████████▏                  | 79/96 [1:03:44<13:49, 48.77s/it]
















 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 95/96 [1:16:13<00:39, 39.78s/it]
{'train_runtime': 4576.4927, 'train_samples_per_second': 0.656, 'train_steps_per_second': 0.021, 'train_loss': 51.95507303873698, 'epoch': 3.0}
Done with training! Pushing to hub...

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 96/96 [1:16:16<00:00, 47.67s/it]












adapter_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████| 923M/923M [00:22<00:00, 40.3MB/s]